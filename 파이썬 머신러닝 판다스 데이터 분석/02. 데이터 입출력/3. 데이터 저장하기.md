<h2>📌 PART 2. 데이터 입출력</h2>
<h3>✓ 3. 데이터 저장하기</h3>

<h4>CSV 파일로 저장</h4>
판다스 데이터프레임은 2차원 배열로 구조화된 데이터이기 때문에 2차원 구조를 갖는 CSV 파일로 변환할 수 있다. <br>
<br>

```python
CSV 파일로 저장: DataFrame 객체.to_csv('파일 이름(경로)')
```
##### <예제 2-7> CSV 파일로 저장 

```python
import pandas as pd

# 판다스 DataFrame() 함수로 데이터프레임 변환. 변수 df에 저장
data = {'name': ['Jerry', 'Riah', 'Paul'],
        'algol': ["A", "A+", "B"],
        'basic': ["C", "B", "B+"],
        'c++': ["B+", "C", "C+"],
}

df = pd.DataFrame(data)
df.set_index('name', inplace=True)   # name 열을 인덱스로 지정
df

# to_csv() 메소드를 사용하여 CSV 파일로 내보내기
df.to_csv("C:/sample_data/df_sample.csv")
```

<h4>JSON 파일로 저장</h4>
데이터프레임을 JSON 파일로 저장하려면 to_json() 메소드를 이용한다.<br>
<br>

```python
JSON 파일로 저장: DataFrame 객체.to_json('파일 이름(경로)')
```
##### <예제 2-8> JSON 파일로 저장 

```python
import pandas as pd

# 판다스 DataFrame() 함수로 데이터프레임 변환. 변수 df에 저장
data = {'name': ['Jerry', 'Riah', 'Paul'],
        'algol': ["A", "A+", "B"],
        'basic': ["C", "B", "B+"],
        'c++': ["B+", "C", "C+"],
}

df = pd.DataFrame(data)
df.set_index('name', inplace=True)   # name 열을 인덱스로 지정
df

# to_json() 메소드를 사용하여 JSON 파일로 내보내기
df.to_json("C:/sample_data/df_sample.json")
```

<h4>Excel 파일로 저장</h4>
데이터프레임은 Excel 파일과 유사한 구조를 갖는다. to_excel() 메소드를 적용하여 저장하는데 to_excel() 메소드를 사용하려면 openpyxl 라이브러리를 사전에 설치해야 한다. 아나콘다 배포판에는 openyxl 라이브러리가 기본 제공되므로 따로 설치하지 않아도 된다. <br>
<br>

```python
Excel 파일로 저장: DataFrame 객체.to_excel('파일 이름(경로)')
```
##### <예제 2-9> Excel 파일로 저장 

```python
import pandas as pd

# 판다스 DataFrame() 함수로 데이터프레임 변환. 변수 df에 저장
data = {'name': ['Jerry', 'Riah', 'Paul'],
        'algol': ["A", "A+", "B"],
        'basic': ["C", "B", "B+"],
        'c++': ["B+", "C", "C+"],
}

df = pd.DataFrame(data)
df.set_index('name', inplace=True)   # name 열을 인덱스로 지정
df

# to_excel() 메소드를 사용하여 Excel 파일로 내보내기
df.to_excel("C:/sample_data/df_sample.xlsx")
```

<h4>여러 개의 데이터프레임을 하나의 Excel 파일로 저장</h4>
판다스 ExcelWriter() 함수는 Excel 워크북을 생성한다. 워크북 객체는 Excel 파일이라고 생각하면 된다. sheet_name 옵션에 Excel 파일의 시트 이름을 입력하여 삽입되는 시트 위치를 지정할 수 있다. <br>
<br>

```python
데이터프레임 여러 개를 Excel 파일로 저장: pandas.ExcelWriter('파일 이름(경로)')
```
##### <예제 2-10> ExcelWriter() 활용

```python
import pandas as pd

# 판다스 DataFrame() 함수로 데이터프레임 변환. 변수 df1, df2에 저장
data1 = {'name': ['Jerry', 'Riah', 'Paul'],
         'algol': ["A", "A+", "B"],
         'basic': ["C", "B", "B+"],
         'c++': ["B+", "C", "C+"],
    }

data2 = {'c0': [1, 2, 3],
         'c1': [4, 5, 6],
         'c2': [7, 8, 9],
         'c3': [10, 11, 12],
         'c4': [13, 14, 15]
    }

df1 = pd.DataFrame(data1)
df1.set_index('name', inplace=True)   # name 열을 인덱스로 지정
df1

df2 = pd.DataFrame(data2)
df2.set_index('c0', inplace=True)   # co 열을 인덱스로 지정
df2

# df1을 'sheet1'으로, df2를 'sheet2'로 저장 (엑셀파일명은 "df_excelwriter.xlsx")
writer = pd.ExcelWriter("C:/sample_data/df_excelwriter.xlsx")
df1.to_excel(writer, sheet_name="sheet1")
df2.to_excel(writer, sheet_name="sheet2")
writer.save()
```
